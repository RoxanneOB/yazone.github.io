
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>破解的那些破事-记手动逆向smali代码 | 云景中天</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="&amp;#x6458;&amp;#x8981;&amp;#xFF1A;&amp;#x7834;&amp;#x89E3;&amp;#x7684;&amp;#x90A3;&amp;#x4E9B;&amp;#x7834;&amp;#x4E8B;-&amp;#x8BB0;&amp;#x624B;&amp;#x52A8;&amp;#x9006;&amp;#x5411;smali&amp;#x4EE3;&amp;#x7801;&amp;#x3002;">
<meta property="og:type" content="article">
<meta property="og:title" content="破解的那些破事-记手动逆向smali代码">
<meta property="og:url" content="http://www.laiwangyo.com/2016/03/10/破解的那些破事-记手动逆向smali代码/index.html">
<meta property="og:site_name" content="云景中天">
<meta property="og:description" content="&amp;#x6458;&amp;#x8981;&amp;#xFF1A;&amp;#x7834;&amp;#x89E3;&amp;#x7684;&amp;#x90A3;&amp;#x4E9B;&amp;#x7834;&amp;#x4E8B;-&amp;#x8BB0;&amp;#x624B;&amp;#x52A8;&amp;#x9006;&amp;#x5411;smali&amp;#x4EE3;&amp;#x7801;&amp;#x3002;">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="破解的那些破事-记手动逆向smali代码">
<meta name="twitter:description" content="&amp;#x6458;&amp;#x8981;&amp;#xFF1A;&amp;#x7834;&amp;#x89E3;&amp;#x7684;&amp;#x90A3;&amp;#x4E9B;&amp;#x7834;&amp;#x4E8B;-&amp;#x8BB0;&amp;#x624B;&amp;#x52A8;&amp;#x9006;&amp;#x5411;smali&amp;#x4EE3;&amp;#x7801;&amp;#x3002;">
  
    <link rel="alternative" href="/atom.xml" title="云景中天" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">云景中天</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">代码中带点唏嘘，生命中带点惊喜</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">文章列表</a>
        
          <a class="main-nav-link" href="/me">关于我</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="www.laiwangyo.com">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-破解的那些破事-记手动逆向smali代码" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/10/破解的那些破事-记手动逆向smali代码/" class="article-date">
  <time datetime="2016-03-10T13:30:00.000Z" itemprop="datePublished">2016-03-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android破解的那些破事/">Android破解的那些破事</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      破解的那些破事-记手动逆向smali代码
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <div class="toc-wrap">
        	<div class="toc-title">Index</div>
        	<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-起因"><span class="toc-number">1.</span> <span class="toc-text">1.起因</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-过程"><span class="toc-number">2.</span> <span class="toc-text">2.过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1_通过HOOK机制抓取传输的数据"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 通过HOOK机制抓取传输的数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2_反编译APK后生成smali文件"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 反编译APK后生成smali文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-3_smali分析过程"><span class="toc-number">3.</span> <span class="toc-text">2.3 smali分析过程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-_总结"><span class="toc-number">4.</span> <span class="toc-text">3. 总结</span></a></li></ol>
    		</div>

        <p>&#x6458;&#x8981;&#xFF1A;&#x7834;&#x89E3;&#x7684;&#x90A3;&#x4E9B;&#x7834;&#x4E8B;-&#x8BB0;&#x624B;&#x52A8;&#x9006;&#x5411;smali&#x4EE3;&#x7801;&#x3002;<a id="more"></a></p>
<h1 id="1-&#x8D77;&#x56E0;">1.&#x8D77;&#x56E0;</h1><p>&#x3000;&#x3000;&#x6700;&#x8FD1;**&#x5BA2;&#x6237;&#x7AEF;&#x5C06;&#x4E4B;&#x524D;&#x56FA;&#x5B9A;RSA&#x516C;&#x94A5;&#x6539;&#x4E3A;&#x52A8;&#x6001;&#x751F;&#x6210;&#x65B9;&#x5F0F;&#xFF0C;&#x5BFC;&#x81F4;&#x6A21;&#x62DF;APP&#x65E0;&#x6CD5;&#x8FDB;&#x884C;&#x6B63;&#x5E38;&#x8BA4;&#x8BC1;&#x3002;&#x6539;&#x5B8C;&#x540E;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;&#x9996;&#x5148;&#x5BA2;&#x6237;&#x7AEF;&#x53D1;&#x9001;RSA&#x516C;&#x94A5;&#x8BF7;&#x6C42;&#xFF0C;&#x670D;&#x52A1;&#x7AEF;&#x751F;&#x6210;&#x516C;&#x94A5;&#x4EE5;&#x53CA;&#x76F8;&#x5173;&#x89E3;&#x5BC6;&#x4FE1;&#x606F;&#x4F20;&#x56DE;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x7136;&#x540E;&#x5BA2;&#x6237;&#x7AEF;&#x901A;&#x8FC7;&#x89E3;&#x5BC6;&#x4FE1;&#x606F;&#x89E3;&#x7801;&#x51FA;RSA&#x516C;&#x94A5;&#xFF0C;&#x518D;&#x7528;&#x8BE5;&#x516C;&#x94A5;&#x52A0;&#x5BC6;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x4F20;&#x8F93;&#x3002;</p>
<h1 id="2-&#x8FC7;&#x7A0B;">2.&#x8FC7;&#x7A0B;</h1><h2 id="2-1_&#x901A;&#x8FC7;HOOK&#x673A;&#x5236;&#x6293;&#x53D6;&#x4F20;&#x8F93;&#x7684;&#x6570;&#x636E;">2.1 &#x901A;&#x8FC7;HOOK&#x673A;&#x5236;&#x6293;&#x53D6;&#x4F20;&#x8F93;&#x7684;&#x6570;&#x636E;</h2><p>&#x3000;&#x3000;HOOK&#x6389;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x6570;&#x636E;&#xFF0C;&#x7531;&#x4E8E;&#x8BE5;&#x5BA2;&#x6237;&#x7AEF;&#x57FA;&#x4E8E;soap&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x9996;&#x5148;&#x4F1A;&#x53D1;&#x9001;&#x4E00;&#x4E2A;action&#x4E3A;rsaPublicKeyDeepProc&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x5F88;&#x5FEB;&#x4FBF;&#x80FD;&#x5224;&#x65AD;&#x4E3A;rsa&#x516C;&#x94A5;&#x751F;&#x6210;&#x8BF7;&#x6C42;&#xFF0C;&#x5185;&#x5BB9;&#x53C2;&#x6570;&#x4E3A;&#xFF1A;<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJmIjoiRVdCWERUSkpCQUNIREREWERGRlRJREFaSkhFQUdXQ1BIWkVaRlJDR0JLQlJHRkNBRUhGSkNYQ1RDR0RVSlNGSkRIR1hCUkdMR1hHWElSRlpGUUdZSUFISEJWSVpBSkdWQlRJSURDSVpDUkFGQ1dIU0NRRUlBRkZOREpGWkdOSlBHRUVDSkNKVkVJRVZJWkpDQ1VES0VHSE9EWUVZSFBJTUdYRVFIVEFBSU5HV0hUQ1ZIWUdBSURKQ0lKRU1KTElUSkVIR0JPRVFKVklQQ0JDSkpKRE1EQkZNRlFHRUJDSEZETUFQQktFQ0RCQkpJTkpERkpJR0RQSkZKTUpIQUxJWkpPRk1CSkhWR09DU0VMSFdBSkdUQVBBTEZNQ1NGRUFCQUlIVUJGQ01FRkZSSVRFS0VSSkZBR0NTSENIU0VJSVlHUUhZRENCTERKQ0xGVklWRlFDVENZSVRCRURWRkpHRkFVQlNDUkNVRlFHUEFOSlVCRkpUQUNBRUJVSERDTkRMREhESEVCQlVFT0lSRldFWUdMSVdHTkdIQ0RDVkpWQkRCQUJVQ0NBWUNIQlpKU0hKQklITkhXIiwiZyI6IjAiLCJkIjoiTVpVMExUWTNZVElUTkdJWU5DMUhNREE0TFdZNVpXTTFORFk0TlpaTFlXIiwiZSI6Ik9DMFpNSlUzTVdWSk9XRTVNR01aSllUWUpVV01DMU1NREZNWk1GSU1EUkpORE1PV000WkpaTVlRTFRSSU5NUVRZV0U1WkkxTE9XVk1ZVEhLTlpZV01aQ0xUUVlNTVFUT0dOS1lJMDRaRFpNTkdWTE1HVVpOSkFOSkkwTVRDNFlUIiwiYiI6IjI1IiwiYyI6IkFCQkRBRkhCSENCSUJKREdKQkdGIiwiYSI6IkxUTVlaREtUTkRWTE5TMUhNRFEyTFRLM1pETTBPRElaWlRESU1XIiwiaCI6Ik1UQkpMVEs0TVpJVE5NVTNOVEU1TVdWTVkyUTQifQ==</span><br></pre></td></tr></table></figure></p>
<p>&#x901A;&#x8FC7;&#x57FA;&#x672C;&#x5224;&#x65AD;&#x5E94;&#x8BE5;&#x4E3A;BASE64&#xFF0C;&#x901A;&#x8FC7;BASE64&#x5728;&#x7EBF;&#x89E3;&#x7801;&#x679C;&#x7136;&#xFF1A;<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">{&quot;f&quot;:&quot;EWBXDTJJBACHDDDXDFFTIDAZJHEAGWCPHZEZFRCGBKBRGFCAEHFJCXCTCGDUJSFJDHGXBRGLGXGXIRFZFQGYIAHHBVIZAJGVBTIIDCIZCRAFCWHSCQEIAFFNDJFZGNJPGEECJCJVEIEVIZJCCUDKEGHODYEYHPIMGXEQHTAAINGWHTCVHYGAIDJCIJEMJLITJEHGBOEQJVIPCBCJJJDMDBFMFQGEBCHFDMAPBKECDBBJINJDFJIGDPJFJMJHALIZJOFMBJHVGOCSELHWAJGTAPALFMCSFEABAIHUBFCMEFFRITEKERJFAGCSHCHSEIIYGQHYDCBLDJCLFVIVFQCTCYITBEDVFJGFAUBSCRCUFQGPANJUBFJTACAEBUHDCNDLDHDHEBBUEOIRFWEYGLIWGNGHCDCVJVBDBABUCCAYCHBZJSHJBIHNHW&quot;,&quot;g&quot;:&quot;0&quot;,&quot;d&quot;:&quot;MZU0LTY3YTITNGIYNC1HMDA4LWY5ZWM1NDY4NZZLYW&quot;,&quot;e&quot;:&quot;OC0ZMJU3MWVJOWE5MGMZJYTYJUWMC1MMDFMZMFIMDRJNDMOWM4ZJZMYQLTRINMQTYWE5ZI1LOWVMYTHKNZYWMZCLTQYMMQTOGNKYI04ZDZMNGVLMGUZNJANJI0MTC4YT&quot;,&quot;b&quot;:&quot;25&quot;,&quot;c&quot;:&quot;ABBDAFHBHCBIBJDGJBGF&quot;,&quot;a&quot;:&quot;LTMYZDKTNDVLNS1HMDQ2LTK3ZDM0ODIZZTDIMW&quot;,&quot;h&quot;:&quot;MTBJLTK4MZITNMU3NTE5MWVMY2Q4&quot;}</span><br></pre></td></tr></table></figure></p>
<p>json&#x683C;&#x5F0F;&#xFF0C;&#x521D;&#x6B65;&#x770B;&#x65E0;&#x8BBA;&#x54EA;&#x4E2A;&#x503C;&#x90FD;&#x4E0D;&#x53EF;&#x80FD;&#x662F;RSA&#x516C;&#x94A5;&#x660E;&#x6587;&#x3002;&#x770B;&#x6765;&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x5982;&#x4F55;&#x5904;&#x7406;&#x8FD9;&#x6BB5;&#x6570;&#x636E;&#x6765;&#x505A;&#x8FDB;&#x4E00;&#x6B65;&#x5206;&#x6790;&#x3002;</p>
<h2 id="2-2_&#x53CD;&#x7F16;&#x8BD1;APK&#x540E;&#x751F;&#x6210;smali&#x6587;&#x4EF6;">2.2 &#x53CD;&#x7F16;&#x8BD1;APK&#x540E;&#x751F;&#x6210;smali&#x6587;&#x4EF6;</h2><p>&#x3000;&#x3000;&#x901A;&#x8FC7;&#x53CD;&#x7F16;&#x8BD1;&#x5DE5;&#x5177;&#xFF08;&#x7F51;&#x4E0A;&#x968F;&#x4FBF;&#x4E0B;&#xFF09;&#x751F;&#x6210;smali&#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x5168;&#x76D8;&#x641C;&#x7D22;rsaPublicKeyDeepProc&#x5B9A;&#x4F4D;&#x5230;smali&#x6587;&#x4EF6;&#xFF0C;&#x4EE3;&#x7801;&#x91CF;&#x76F8;&#x5F53;&#x5927;&#xFF0C;&#x53C8;&#x7ECF;&#x8FC7;&#x6DF7;&#x6DC6;&#xFF0C;&#x4E0D;&#x8FC7;&#x901A;&#x8FC7;&#x5173;&#x952E;&#x4FE1;&#x606F;&#x8FD8;&#x662F;&#x80FD;&#x770B;&#x5230;&#x8BF8;&#x5982;&#x5BF9;json&#x6570;&#x636E;&#x7684;&#x5904;&#x7406;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span>-string v4, <span class="string">&quot;f&quot;</span></span><br><span class="line"><span class="keyword">const</span>-string v6, <span class="string">&quot;&quot;</span></span><br><span class="line">invoke-virtual {v2, v4, v6}, Lorg/json/JSONObject;-&gt;optString(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;</span><br><span class="line">move-result-object v4</span><br></pre></td></tr></table></figure></p>
<p>&#x6293;&#x4F4F;&#x8FD9;&#x4E9B;&#x503C;&#x4E00;&#x6B65;&#x6B65;&#x8DDF;&#x8E2A;&#xFF0C;&#x8010;&#x5FC3;&#x5F88;&#x91CD;&#x8981;&#xFF0C;&#x6700;&#x7EC8;&#x53D1;&#x73B0;&#x8C03;&#x7528;&#x4E86;&#x89E3;&#x7801;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">invoke-direct {p0, v0, v2}, Lcom/chinapost/publiclibrary/g;-&gt;a([CS)Ljava/lang/String;</span><br></pre></td></tr></table></figure></p>
<p>&#x5173;&#x952E;&#x95EE;&#x9898;&#x662F;&#x8C03;&#x7528;&#x4E86;&#x5B83;&#xFF0C;&#x53C8;&#x4E0D;&#x80FD;&#x50CF;C&#x4E00;&#x6837;&#x76F4;&#x63A5;&#x5D4C;&#x5165;&#x6C47;&#x7F16;&#x90A3;&#x6837;&#x5728;java&#x6587;&#x4EF6;&#x91CC;&#x5F15;&#x7528;smali&#x4EE3;&#x7801;&#xFF0C;&#x5230;&#x8FD9;&#x4E00;&#x6B65;&#x53EA;&#x80FD;&#x5206;&#x6790;&#x7B97;&#x6CD5;&#x4E86;&#x3002;</p>
<h1 id="2-3_smali&#x5206;&#x6790;&#x8FC7;&#x7A0B;">2.3 smali&#x5206;&#x6790;&#x8FC7;&#x7A0B;</h1><p>&#x3000;&#x3000;&#x89E3;&#x7801;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">.method</span><span class="keyword"> private</span><span class="function"> a(</span><span class="keyword">[</span>CS<span class="function">)</span><span class="class">Ljava/lang/String;</span></span><br><span class="line"><span class="keyword">    .locals</span> 6</span><br><span class="line"><span class="keyword">    .parameter</span></span><br><span class="line"><span class="keyword">    .parameter</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .prologue</span></span><br><span class="line">   <span class="instruction"> const/4 </span><span class="variable">v1</span>, 0x0</span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 473</span><br><span class="line">   <span class="instruction"> array-length </span><span class="variable">v0</span>, <span class="variable">p1</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> div-int/lit8 </span><span class="variable">v0</span>, <span class="variable">v0</span>, 0x2</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> new-array </span><span class="variable">v2</span>, <span class="variable">v0</span>, <span class="keyword">[</span>C</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> move </span><span class="variable">v0</span>, <span class="variable">v1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 475</span><br><span class="line">   <span class="keyword"> :goto_0</span></span><br><span class="line">   <span class="instruction"> array-length </span><span class="variable">v3</span>, <span class="variable">p1</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> div-int/lit8 </span><span class="variable">v3</span>, <span class="variable">v3</span>, 0x2</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> if-lt </span><span class="variable">v0</span>, <span class="variable">v3</span>,<span class="keyword"> :cond_0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 484</span><br><span class="line">   <span class="instruction"> new-instance </span><span class="variable">v3</span>, <span class="class">Ljava/lang/StringBuffer;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> invoke-direct </span>{<span class="variable">v3</span>}, <span class="class">Ljava/lang/StringBuffer;</span><span class="function">-&gt;&lt;init&gt;(</span><span class="function">)</span>V</span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 485</span><br><span class="line">   <span class="keyword"> :goto_1</span></span><br><span class="line">   <span class="instruction"> array-length </span><span class="variable">v0</span>, <span class="variable">v2</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> if-lt </span><span class="variable">v1</span>, <span class="variable">v0</span>,<span class="keyword"> :cond_1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 497</span><br><span class="line">   <span class="instruction"> invoke-virtual </span>{<span class="variable">v3</span>}, <span class="class">Ljava/lang/StringBuffer;</span><span class="function">-&gt;toString(</span><span class="function">)</span><span class="class">Ljava/lang/String;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> move-result-object </span><span class="variable">v0</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> return-object </span><span class="variable">v0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 478</span><br><span class="line">   <span class="keyword"> :cond_0</span></span><br><span class="line">   <span class="instruction"> mul-int/lit8 </span><span class="variable">v3</span>, <span class="variable">v0</span>, 0x2</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> aget-char </span><span class="variable">v3</span>, <span class="variable">p1</span>, <span class="variable">v3</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sget </span><span class="variable">v4</span>, <span class="class">Lcom/chinapost/publiclibrary/g;</span>-&gt;h:I</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sub-int/2addr </span><span class="variable">v3</span>, <span class="variable">v4</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> mul-int/lit8 </span><span class="variable">v3</span>, <span class="variable">v3</span>, 0x1a</span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 479</span><br><span class="line">   <span class="instruction"> mul-int/lit8 </span><span class="variable">v4</span>, <span class="variable">v0</span>, 0x2</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> add-int/lit8 </span><span class="variable">v4</span>, <span class="variable">v4</span>, 0x1</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> aget-char </span><span class="variable">v4</span>, <span class="variable">p1</span>, <span class="variable">v4</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sget </span><span class="variable">v5</span>, <span class="class">Lcom/chinapost/publiclibrary/g;</span>-&gt;h:I</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sub-int/2addr </span><span class="variable">v4</span>, <span class="variable">v5</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> add-int/2addr </span><span class="variable">v3</span>, <span class="variable">v4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 480</span><br><span class="line">   <span class="instruction"> int-to-char </span><span class="variable">v3</span>, <span class="variable">v3</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> aput-char </span><span class="variable">v3</span>, <span class="variable">v2</span>, <span class="variable">v0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 475</span><br><span class="line">   <span class="instruction"> add-int/lit8 </span><span class="variable">v0</span>, <span class="variable">v0</span>, 0x1</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> goto </span>:goto_0</span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 487</span><br><span class="line">   <span class="keyword"> :cond_1</span></span><br><span class="line">   <span class="instruction"> shr-int/lit8 </span><span class="variable">v0</span>, <span class="variable">p2</span>, 0x8</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">v0</span>, <span class="variable">v0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 488</span><br><span class="line">   <span class="instruction"> aget-char </span><span class="variable">v4</span>, <span class="variable">v2</span>, <span class="variable">v1</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">v4</span>, <span class="variable">v4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 489</span><br><span class="line">   <span class="instruction"> xor-int/2addr </span><span class="variable">v0</span>, <span class="variable">v4</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">v0</span>, <span class="variable">v0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 490</span><br><span class="line">   <span class="instruction"> add-int/2addr </span><span class="variable">v4</span>, <span class="variable">p2</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">v4</span>, <span class="variable">v4</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sget </span><span class="variable">v5</span>, <span class="class">Lcom/chinapost/publiclibrary/g;</span>-&gt;f:I</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> mul-int/2addr </span><span class="variable">v4</span>, <span class="variable">v5</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sget </span><span class="variable">v5</span>, <span class="class">Lcom/chinapost/publiclibrary/g;</span>-&gt;g:I</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> add-int/2addr </span><span class="variable">v4</span>, <span class="variable">v5</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">p2</span>, <span class="variable">v4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 492</span><br><span class="line">   <span class="instruction"> if-gez </span><span class="variable">v0</span>,<span class="keyword"> :cond_2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 493</span><br><span class="line">   <span class="instruction"> add-int/lit16 </span><span class="variable">v0</span>, <span class="variable">v0</span>, 0x100</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">v0</span>, <span class="variable">v0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 495</span><br><span class="line">   <span class="keyword"> :cond_2</span></span><br><span class="line">   <span class="instruction"> int-to-char </span><span class="variable">v0</span>, <span class="variable">v0</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> invoke-virtual </span>{<span class="variable">v3</span>, <span class="variable">v0</span>}, <span class="class">Ljava/lang/StringBuffer;</span><span class="function">-&gt;append(</span>C<span class="function">)</span><span class="class">Ljava/lang/StringBuffer;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 485</span><br><span class="line">   <span class="instruction"> add-int/lit8 </span><span class="variable">v1</span>, <span class="variable">v1</span>, 0x1</span><br><span class="line"></span><br><span class="line">   <span class="instruction"> goto </span>:goto_1<span class="keyword"></span><br><span class="line">.end method</span></span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x679C;&#x5149;&#x8FD9;&#x4E48;&#x770B;&#x53EF;&#x80FD;&#x5C31;&#x8981;&#x75AF;&#x4E86;&#xFF0C;&#x60F3;&#x5230;Smaili2JavaUI&#xFF0C;&#x5751;&#x7239;&#x7684;&#x662F;&#x5C45;&#x7136;&#x201C;&#x63D0;&#x793A;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x53EF;&#x80FD;&#x8FDB;&#x884C;&#x8FC7;&#x4F18;&#x5316;&#x201D;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">a</span><span class="params">(<span class="keyword">char</span>[] p1, <span class="keyword">short</span> p2)</span> </span>{</span><br><span class="line">    <span class="comment">// :( Parsing error. Please contact me.</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x90A3;&#x53EA;&#x6709;&#x4E00;&#x6B65;&#x6B65;&#x5206;&#x6790;&#x4E86;&#xFF0C;&#x6CE8;&#x91CA;&#x5F88;&#x91CD;&#x8981;&#xFF0C;&#x5F00;&#x59CB;&#x6CE8;&#x91CA;&#xFF1A;</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line">method<span class="keyword"> private</span><span class="function"> a(</span><span class="keyword">[</span>CS<span class="function">)</span><span class="class">Ljava/lang/String;</span></span><br><span class="line"><span class="keyword">    .locals</span> 6	 <span class="comment"># 6&#x4E2A;&#x5BC4;&#x5B58;&#x5668;</span></span><br><span class="line"><span class="keyword">    .parameter</span> <span class="comment"># &#x53C2;&#x6570;1&#x5B57;&#x7B26;&#x6570;&#x7EC4;</span></span><br><span class="line"><span class="keyword">    .parameter</span> <span class="comment"># &#x53C2;&#x6570;2&#x957F;&#x5EA6;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .prologue</span></span><br><span class="line">   <span class="instruction"> const/4 </span><span class="variable">v1</span>, 0x0 <span class="comment">#&#x5B9A;&#x4E49;&#x5E38;&#x91CF;0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 473</span><br><span class="line">   <span class="instruction"> array-length </span><span class="variable">v0</span>, <span class="variable">p1</span> <span class="comment"># &#x53C2;&#x6570;1&#x5B57;&#x7B26;&#x6570;&#x7EC4;&#x957F;&#x5EA6;&#xFF08;438&#xFF09;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> div-int/lit8 </span><span class="variable">v0</span>, <span class="variable">v0</span>, 0x2 <span class="comment"># &#x53C2;&#x6570;1&#x957F;&#x5EA6;&#x9664;2&#xFF08;219&#xFF09;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> new-array </span><span class="variable">v2</span>, <span class="variable">v0</span>, <span class="keyword">[</span>C <span class="comment">#&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x6570;&#x7EC4;&#xFF0C;&#x957F;&#x5EA6;&#x4E3A;&#x4E00;&#x534A;&#xFF08;219&#xFF09;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> move </span><span class="variable">v0</span>, <span class="variable">v1</span> <span class="comment"># &#x8BBE;&#x7F6E;&#x53D8;&#x91CF;&#x4E3A;0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 475</span><br><span class="line">   <span class="keyword"> :goto_0</span></span><br><span class="line">   <span class="instruction"> array-length </span><span class="variable">v3</span>, <span class="variable">p1</span> <span class="comment"># &#x957F;&#x5EA6;438</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> div-int/lit8 </span><span class="variable">v3</span>, <span class="variable">v3</span>, 0x2 <span class="comment">#&#x957F;&#x5EA6;219</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> if-lt </span><span class="variable">v0</span>, <span class="variable">v3</span>,<span class="keyword"> :cond_0</span> &#x53D8;&#x91CF;<span class="variable">v0</span>&lt;219&#x8DF3;&#x5230;cond_0</span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 484</span><br><span class="line">   <span class="instruction"> new-instance </span><span class="variable">v3</span>, <span class="class">Ljava/lang/StringBuffer;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> invoke-direct </span>{<span class="variable">v3</span>}, <span class="class">Ljava/lang/StringBuffer;</span><span class="function">-&gt;&lt;init&gt;(</span><span class="function">)</span>V</span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 485</span><br><span class="line">   <span class="keyword"> :goto_1</span></span><br><span class="line">   <span class="instruction"> array-length </span><span class="variable">v0</span>, <span class="variable">v2</span> <span class="comment"># &#x65B0;&#x6570;&#x636E;&#x957F;&#x5EA6;&#xFF08;219&#xFF09;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> if-lt </span><span class="variable">v1</span>, <span class="variable">v0</span>,<span class="keyword"> :cond_1</span> <span class="comment"># &#x53D8;&#x91CF;v1&lt;219&#x8DF3;&#x5230;cond_1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 497</span><br><span class="line">   <span class="instruction"> invoke-virtual </span>{<span class="variable">v3</span>}, <span class="class">Ljava/lang/StringBuffer;</span><span class="function">-&gt;toString(</span><span class="function">)</span><span class="class">Ljava/lang/String;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> move-result-object </span><span class="variable">v0</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> return-object </span><span class="variable">v0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 478</span><br><span class="line">   <span class="keyword"> :cond_0</span></span><br><span class="line">   <span class="instruction"> mul-int/lit8 </span><span class="variable">v3</span>, <span class="variable">v0</span>, 0x2 <span class="comment"># &#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#x8BB0;&#x5F55;&#x5230;v3</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> aget-char </span><span class="variable">v3</span>, <span class="variable">p1</span>, <span class="variable">v3</span> <span class="comment"># &#x83B7;&#x53D6;&#x5B57;&#x7B26;&#x4E32;&#x6570;&#x7EC4;&#x4E2D;&#x7684;v3&#x4F4D;&#x7F6E;&#x7684;&#x503C;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sget </span><span class="variable">v4</span>, <span class="class">Lcom/chinapost/publiclibrary/g;</span>-&gt;h:I <span class="comment">#&#x83B7;&#x53D6;&#x53D8;&#x91CF;h</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sub-int/2addr </span><span class="variable">v3</span>, <span class="variable">v4</span> <span class="comment"># &#x5F53;&#x524D;&#x503C;&#x51CF;&#x53BB;&#x53D8;&#x91CF;h&#x5B58;&#x653E;&#x5230;v3</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> mul-int/lit8 </span><span class="variable">v3</span>, <span class="variable">v3</span>, 0x1a <span class="comment"># v3&#x4E58;&#x4EE5;0x1a&#x5B58;&#x653E;&#x5230;v3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 479</span><br><span class="line">   <span class="instruction"> mul-int/lit8 </span><span class="variable">v4</span>, <span class="variable">v0</span>, 0x2 <span class="comment"># &#x7D22;&#x5F15;v0&#x6210;2&#x4F4D;&#x5F53;&#x524D;&#x5B57;&#x7B26;&#x4E32;&#x4F4D;&#x7F6E;&#xFF08;&#x5076;&#x6570;&#xFF09;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> add-int/lit8 </span><span class="variable">v4</span>, <span class="variable">v4</span>, 0x1 <span class="comment"># &#x5F53;&#x524D;&#x5B57;&#x7B26;&#x4E32;&#x4F4D;&#x7F6E;&#xFF08;&#x5947;&#x6570;&#xFF09;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> aget-char </span><span class="variable">v4</span>, <span class="variable">p1</span>, <span class="variable">v4</span> <span class="comment"># &#x83B7;&#x53D6;&#x5F53;&#x524D;&#x5B57;&#x7B26;&#x4E32;&#x4F4D;&#x7F6E;&#x7684;&#x503C;&#xFF08;&#x5947;&#x6570;&#xFF09;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sget </span><span class="variable">v5</span>, <span class="class">Lcom/chinapost/publiclibrary/g;</span>-&gt;h:I <span class="comment"># &#x83B7;&#x53D6;&#x53D8;&#x91CF;h</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sub-int/2addr </span><span class="variable">v4</span>, <span class="variable">v5</span> <span class="comment"># &#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#x7684;&#x503C;&#x51CF;&#x53BB;&#x53D8;&#x91CF;h&#x5B58;&#x653E;&#x56DE;v4</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> add-int/2addr </span><span class="variable">v3</span>, <span class="variable">v4</span> <span class="comment"># &#x5076;&#x6570;&#x4F4D;&#x8BA1;&#x7B97;&#x7684;&#x503C;+&#x5947;&#x6570;&#x4E3A;&#x8BA1;&#x7B97;&#x7684;&#x503C;=v3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 480</span><br><span class="line">   <span class="instruction"> int-to-char </span><span class="variable">v3</span>, <span class="variable">v3</span> <span class="comment"># &#x5C06;v3&#x8F6C;&#x6210;char</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> aput-char </span><span class="variable">v3</span>, <span class="variable">v2</span>, <span class="variable">v0</span> <span class="comment"># &#x5C06;v3&#x5B58;&#x5165;&#x5230;&#x65B0;&#x521B;&#x5EFA;&#x7684;&#x6570;&#x7EC4;&#x4E2D;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 475</span><br><span class="line">   <span class="instruction"> add-int/lit8 </span><span class="variable">v0</span>, <span class="variable">v0</span>, 0x1 <span class="comment">#&#x7D22;&#x5F15;&#x52A0;1</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> goto </span>:goto_0</span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 487</span><br><span class="line">   <span class="keyword"> :cond_1</span></span><br><span class="line">   <span class="instruction"> shr-int/lit8 </span><span class="variable">v0</span>, <span class="variable">p2</span>, 0x8 <span class="comment"># v0=p2&gt;&gt;0x8;&#x83B7;&#x53D6;&#x53C2;&#x6570;2&#x9AD8;8&#x4F4D;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">v0</span>, <span class="variable">v0</span> <span class="comment"># v0&#x8F6C;&#x6210;short</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 488</span><br><span class="line">   <span class="instruction"> aget-char </span><span class="variable">v4</span>, <span class="variable">v2</span>, <span class="variable">v1</span> <span class="comment"># &#x83B7;&#x53D6;&#x65B0;&#x6570;&#x7EC4;v2&#x7684;&#x7D22;&#x5F15;v1&#x7684;&#x503C;&#x5230;v4 v4=v2[v1];</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">v4</span>, <span class="variable">v4</span> <span class="comment"># v4=(short)v4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 489</span><br><span class="line">   <span class="instruction"> xor-int/2addr </span><span class="variable">v0</span>, <span class="variable">v4</span> <span class="comment"># &#x4E0E;&#x53C2;&#x6570;2&#x9AD8;8&#x4F4D;&#x5F02;&#x6216;,&#x5F02;&#x6216;&#x7ED3;&#x679C;&#x653E;&#x5165;v0</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">v0</span>, <span class="variable">v0</span> <span class="comment"># v0=(short)v0;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 490</span><br><span class="line">   <span class="instruction"> add-int/2addr </span><span class="variable">v4</span>, <span class="variable">p2</span><span class="comment"># v4 = &#x5F53;&#x524D;&#x6570;&#x7EC4;&#x5143;&#x7D20;v4+&#x53C2;&#x6570;2p2</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">v4</span>, <span class="variable">v4</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sget </span><span class="variable">v5</span>, <span class="class">Lcom/chinapost/publiclibrary/g;</span>-&gt;f:I <span class="comment">#&#x83B7;&#x53D6;&#x53D8;&#x91CF;f</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> mul-int/2addr </span><span class="variable">v4</span>, <span class="variable">v5</span> <span class="comment"># v4=v4*f;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> sget </span><span class="variable">v5</span>, <span class="class">Lcom/chinapost/publiclibrary/g;</span>-&gt;g:I<span class="comment">#&#x53D8;&#x91CF;g</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> add-int/2addr </span><span class="variable">v4</span>, <span class="variable">v5</span><span class="comment"># v4 = v4+g;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">p2</span>, <span class="variable">v4</span> <span class="comment">#&#x6539;&#x53D8;&#x53C2;&#x6570;2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 492</span><br><span class="line">   <span class="instruction"> if-gez </span><span class="variable">v0</span>,<span class="keyword"> :cond_2</span> <span class="comment"># &#x5982;&#x679C;&#x5F02;&#x6216;&#x7ED3;&#x679C;&#x5927;&#x4E8E;&#x7B49;&#x4E8E;0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 493</span><br><span class="line">   <span class="instruction"> add-int/lit16 </span><span class="variable">v0</span>, <span class="variable">v0</span>, 0x100 <span class="comment"># &#x5F02;&#x6216;&#x7ED3;&#x679C;v0=v10+0x100;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> int-to-short </span><span class="variable">v0</span>, <span class="variable">v0</span> <span class="comment"># v0=(short)v0;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 495</span><br><span class="line">   <span class="keyword"> :cond_2</span></span><br><span class="line">   <span class="instruction"> int-to-char </span><span class="variable">v0</span>, <span class="variable">v0</span> <span class="comment"># v0=(char)v0;</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> invoke-virtual </span>{<span class="variable">v3</span>, <span class="variable">v0</span>}, <span class="class">Ljava/lang/StringBuffer;</span><span class="function">-&gt;append(</span>C<span class="function">)</span><span class="class">Ljava/lang/StringBuffer;</span> <span class="comment">#&#x6DFB;&#x52A0;&#x5230;StringBuffer&#x4E2D;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">    .line</span> 485</span><br><span class="line">   <span class="instruction"> add-int/lit8 </span><span class="variable">v1</span>, <span class="variable">v1</span>, 0x1 <span class="comment"># &#x7D22;&#x5F15;+1</span></span><br><span class="line"></span><br><span class="line">   <span class="instruction"> goto </span>:goto_1<span class="keyword"></span><br><span class="line">.end method</span></span><br></pre></td></tr></table></figure>
<p>&#x901A;&#x8FC7;&#x8FB9;&#x5206;&#x6790;&#x8FB9;&#x6CE8;&#x91CA;&#xFF0C;&#x5F88;&#x5FEB;&#x660E;&#x767D;&#x7B97;&#x6CD5;&#x5927;&#x6982;&#x610F;&#x601D;&#x662F;&#xFF1A;<br>&#x3000;1&#x3001;&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x6570;&#x7EC4;&#x3002;<br>&#x3000;2&#x3001;&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x8BA1;&#x7B97;&#x6570;&#x503C;&#x3002;<br>&#x3000;3&#x3001;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5B57;&#x7B26;&#x6570;&#x7EC4;&#x3002;<br>&#x3000;4&#x3001;&#x5C06;&#x5B57;&#x7B26;&#x6570;&#x7EC4;&#x901A;&#x8FC7;&#x5947;&#x6570;&#x4F4D;&#x548C;&#x5076;&#x6570;&#x4F4D;&#x4FE9;&#x4FE9;&#x5408;&#x5E76;&#x5230;&#x65B0;&#x7684;&#x5B57;&#x7B26;&#x6570;&#x7EC4;&#x3002;<br>&#x3000;5&#x3001;&#x5BF9;&#x65B0;&#x7684;&#x5B57;&#x7B26;&#x6570;&#x7EC4;&#x901A;&#x8FC7;&#x8BA1;&#x7B97;&#x6570;&#x5B57;&#x5BF9;&#x6BCF;&#x4E00;&#x4F4D;&#x8FDB;&#x884C;&#x8BA1;&#x7B97;&#x5F97;&#x51FA;&#x65B0;&#x7684;&#x5B57;&#x7B26;&#x5E76;&#x4FDD;&#x5B58;&#xFF0C;&#x540C;&#x65F6;&#x66F4;&#x65B0;&#x8BA1;&#x7B97;&#x6570;&#x503C;&#x3002;</p>
<p>&#x6839;&#x636E;&#x8BE5;&#x601D;&#x60F3;&#x4E00;&#x884C;&#x884C;&#x4EE3;&#x7801;&#x5BF9;&#x7167;&#x5B8C;&#x6210;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">caculatePublicRSA</span><span class="params">(<span class="keyword">char</span>[] p1, <span class="keyword">short</span> p2, <span class="keyword">int</span> h,<span class="keyword">int</span> f, <span class="keyword">int</span> g)</span> </span>{</span><br><span class="line">	<span class="keyword">int</span> p2Length = p1.length;</span><br><span class="line">	<span class="keyword">int</span> p2NewLength = p2Length/<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">char</span>[] newChars = <span class="keyword">new</span> <span class="keyword">char</span>[p2NewLength];</span><br><span class="line">	<span class="keyword">int</span> firstIndex = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (firstIndex &lt; p2NewLength) {</span><br><span class="line">		<span class="comment">// &#x8BA1;&#x7B97;&#x5076;&#x6570;&#x4F4D;</span></span><br><span class="line">		<span class="keyword">int</span> currentEventIndex = firstIndex * <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">char</span> currentEventChar = p1[currentEventIndex];</span><br><span class="line">		<span class="keyword">int</span> firstValue = (currentEventChar - h) * <span class="number">0x1a</span>; <span class="comment">// &#x5F97;&#x51FA;&#x7B2C;&#x4E00;&#x4E2A;&#x503C;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// &#x8BA1;&#x7B97;&#x5947;&#x6570;&#x4F4D;</span></span><br><span class="line">		<span class="keyword">int</span> currentOddIndex = firstIndex * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">char</span> currentOddChar = p1[currentOddIndex];</span><br><span class="line">		<span class="keyword">int</span> secordValue = currentOddChar - h; <span class="comment">// &#x5F97;&#x51FA;&#x7B2C;&#x4E00;&#x4E2A;&#x503C;</span></span><br><span class="line">		<span class="keyword">int</span> resultValue = firstValue + secordValue;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// &#x5B58;&#x5165;&#x5230;&#x65B0;&#x6570;&#x7EC4;&#x4E2D;</span></span><br><span class="line">		newChars[firstIndex] = (<span class="keyword">char</span>)resultValue;</span><br><span class="line">		firstIndex++;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	StringBuilder strBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">	<span class="keyword">int</span> secondIndex = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(secondIndex &lt; p2NewLength) {</span><br><span class="line">		<span class="keyword">short</span> high8Bits = (<span class="keyword">short</span>) (p2 &gt;&gt; <span class="number">8</span>); <span class="comment">// &#x9AD8;8&#x4F4D;</span></span><br><span class="line">		<span class="keyword">char</span> currentChar = newChars[secondIndex];</span><br><span class="line">		<span class="keyword">short</span> shortResult = (<span class="keyword">short</span>) (currentChar^high8Bits);</span><br><span class="line">		<span class="keyword">int</span> secondValue = currentChar + p2;</span><br><span class="line">		secondValue = secondValue*f + g;</span><br><span class="line">		p2 = (<span class="keyword">short</span>) secondValue;</span><br><span class="line">		<span class="keyword">if</span> (shortResult&lt;<span class="number">0</span>) {</span><br><span class="line">			shortResult = (<span class="keyword">short</span>) (shortResult + <span class="number">0x100</span>);</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">char</span> realResult = (<span class="keyword">char</span>)shortResult;</span><br><span class="line">		strBuilder.append(realResult);</span><br><span class="line">		secondIndex++;</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> strBuilder.toString();</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x78B0;&#x5230;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x7528;&#x53C2;&#x6570;&#x8868;&#x793A;&#xFF0C;&#x4F8B;&#x5982;h&#x3001;f&#x3001;g&#xFF0C;&#x518D;&#x5206;&#x6790;&#x5408;&#x9002;&#x8BBE;&#x7F6E;&#x6765;&#x8BBE;&#x7F6E;&#x4F20;&#x5165;&#x503C;&#x3002;&#x6700;&#x7EC8;&#x4E00;&#x6B21;&#x9A8C;&#x8BC1;&#x89E3;&#x7801;&#x6210;&#x529F;&#xFF1A;</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCaHHq6qavIJHu/KdTny9kzEkx30Jeg8Q1k45ZW\nB
y/uSaUGr1nK4d3wXJ22zG8aCA3QdoY5VX5Fr+A78gtmV8gtLL/Sj0kq7w7L4xJH/yC8KIkm/i
GfNhtb1EyOFhQipt6uYAJemxkSl0BD2CBOcVWTTpAJr5U3NoFhRuVj+lZQIDAQAB</span><br></pre></td></tr></table></figure>
<h1 id="3-_&#x603B;&#x7ED3;">3. &#x603B;&#x7ED3;</h1><p>&#x3000;&#x3000;Smali&#x4EE3;&#x7801;&#x4E0D;&#x5BB9;&#x6613;&#x770B;&#x7684;&#x539F;&#x56E0;&#x662F;&#x53D8;&#x91CF;&#x8868;&#x8FBE;&#x7528;&#x7684;&#x662F;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;&#x540C;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x5728;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x65F6;&#x8868;&#x8FBE;&#x4E86;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#x610F;&#x601D;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x7F16;&#x5199;smali&#x8F6C;java&#x4EE3;&#x7801;&#x65F6;&#x6709;&#x5FC5;&#x8981;&#x5BF9;&#x9700;&#x8981;&#x7FFB;&#x8BD1;&#x7684;smali&#x884C;&#x8FDB;&#x884C;&#x6CE8;&#x91CA;&#xFF0C;&#x6CE8;&#x91CA;&#x65F6;&#x7528;&#x5BB9;&#x6613;&#x8BB0;&#x4F4F;&#x8BED;&#x8A00;&#x8868;&#x8FBE;&#xFF0C;&#x4F8B;&#x5982;&#x67D0;&#x67D0;&#x7D22;&#x5F15;&#x7B49;&#x3002;<br>&#x3000;&#x3000;&#x53E6;&#x5916;&#x6307;&#x4EE4;&#x67E5;&#x8BE2;&#x662F;&#x4E0D;&#x53EF;&#x5C11;&#x7684;&#xFF1A;<a href="http://blog.sina.com.cn/s/blog_6400e5c50102v3le.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_6400e5c50102v3le.html</a></p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://www.laiwangyo.com/2016/03/10/破解的那些破事-记手动逆向smali代码/" data-id="cilso418y000i44m329r05a19" class="article-share-link" data-share="baidu">分享到</a>
      

      
        <a href="http://www.laiwangyo.com/2016/03/10/破解的那些破事-记手动逆向smali代码/#ds-thread" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/03/15/Android开源项目分析-Volley/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">
        
          Android开源项目分析-Volley
        
      </div>
    </a>
  
  
    <a href="/2016/03/03/自定义界面脚本引擎XModeEngine-（三）变量与函数/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">自定义界面脚本引擎XModeEngine-（三）变量与函数</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <div id="ds-thread" class="ds-thread" data-thread-key="2016/03/10/破解的那些破事-记手动逆向smali代码/" data-title="破解的那些破事-记手动逆向smali代码" data-url="http://www.laiwangyo.com/2016/03/10/破解的那些破事-记手动逆向smali代码/"></div>
  </section>
</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android开源项目分析/">Android开源项目分析</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android破解的那些破事/">Android破解的那些破事</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Openfire/">Openfire</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/XModeEngine脚本引擎/">XModeEngine脚本引擎</a><span class="category-list-count">3</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Openfire/">Openfire</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a><a href="/tags/Openfire/" style="font-size: 10px;">Openfire</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/03/15/Android开源项目分析-Volley/">Android开源项目分析-Volley</a>
          </li>
        
          <li>
            <a href="/2016/03/10/破解的那些破事-记手动逆向smali代码/">破解的那些破事-记手动逆向smali代码</a>
          </li>
        
          <li>
            <a href="/2016/03/03/自定义界面脚本引擎XModeEngine-（三）变量与函数/">自定义界面脚本引擎XModeEngine-（三）变量与函数</a>
          </li>
        
          <li>
            <a href="/2016/03/02/自定义界面脚本引擎XModeEngine-（二）视图元素与事件/">自定义界面脚本引擎XModeEngine-（二）视图元素与事件</a>
          </li>
        
          <li>
            <a href="/2016/03/01/自定义界面脚本引擎XModeEngine-（一）描述/">自定义界面脚本引擎XModeEngine-（一）描述</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://taoyuanxiaoqi.com" target="_blank">桃园小七</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Powered by <a href=http://www.laiwangyo.com target="_blank">yazone</a><br>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">文章列表</a>
  
    <a href="/me" class="mobile-nav-link">关于我</a>
  
</nav>
  <!-- totop start -->

<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<!-- 多说公共js代码 start -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yazone"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共js代码 end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>window._bd_share_config={"common":{},"share":{"bdCustomStyle":"/css/bdshare.css"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/script.js" type="text/javascript"></script>

</div>
</body>
</html>
